<!DOCTYPE html>
<html lang="ar">
<head>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        .video-box { width: 100%; max-width: 800px; margin: auto; background: #000; }
        #my-player { width: 100%; height: auto; aspect-ratio: 16/9; }
    </style>
</head>
<body>

<div class="video-box">
    <video id="my-player" class="video-js vjs-default-skin" controls preload="auto"></video>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script>
    async function loadKickStream(channelName) {
        try {
            // نطلب الرابط من "وظيفتك" على Vercel وليس من Kick مباشرة
            const response = await fetch(`/api/getStream?channel=${channelName}`);
            const data = await response.json();

            if (data.url) {
                const player = videojs('my-player');
                player.src({ src: data.url, type: 'application/x-mpegURL' });
                player.play();
            } else {
                console.error("البث غير متوفر");
            }
        } catch (e) {
            console.error("خطأ في الاتصال بالخادم");
        }
    }

    // استبدل 'اسم_القناة' باسم قناتك الفعلي
    loadKickStream('sxb');
</script>
</body>
</html>
