<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        body { margin: 0; background-color: #000; }
        .container { width: 100%; max-width: 960px; margin: 20px auto; }
        #kick-player { width: 100%; height: auto; aspect-ratio: 16/9; }
    </style>
</head>
<body>

<div class="container">
    <video id="kick-player" class="video-js vjs-big-play-centered" controls preload="auto">
        <p class="vjs-no-js">يرجى تفعيل الجافا سكربت لمشاهدة البث.</p>
    </video>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script>
    async function startStream(channelUser) {
        // نستخدم وسيطاً (Proxy) لتجاوز حماية المتصفح (CORS)
        const proxyUrl = "https://cors-anywhere.herokuapp.com/"; 
        const kickApi = `https://kick.com/api/v1/channels/${channelUser}`;

        try {
            // جلب بيانات القناة
            const response = await fetch(proxyUrl + kickApi);
            const data = await response.json();
            
            // استخراج رابط البث الفعلي .m3u8
            const streamUrl = data.playback_url;

            if (streamUrl) {
                const player = videojs('kick-player');
                player.src({
                    src: streamUrl,
                    type: 'application/x-mpegURL' // التنسيق المطلوب للبث المباشر
                });
                player.play();
            } else {
                alert("البث غير متاح حالياً لهذه القناة.");
            }
        } catch (error) {
            console.error("حدث خطأ أثناء جلب البث:", error);
            alert("فشل تحميل البث. تأكد من اسم القناة أو جرب لاحقاً.");
        }
    }

    // ضع اسم القناة هنا بدلاً من 'اسم_القناة'
    startStream('sxb');
</script>
</body>
</html>
